harbor_namespace: harbor
harbor_host_name: harbor # alias of "rancher"
# harbor_admin_pass: {vault.yml}

# remember to add harbor.fourteeners.local to pfSense DNS!
# https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_filters.html#products
harbor_fqdn: "{{ [harbor_host_name] | product(search_domains) | map('join','.') | first }}"

harbor_chart_version: "1.16.2"
# https://goharbor.io/docs/latest/install-config/harbor-ha-helm/
# https://github.com/goharbor/harbor-helm/blob/main/values.yaml
harbor_chart_values:
  externalURL: https://{{ harbor_fqdn }}
  harborAdminPassword: "{{ harbor_admin_pass }}"
  expose:
    type: ingress
    ingress:
      hosts:
        core: "{{ harbor_fqdn }}"
      className: "{{ k3s_ingress_class }}"
    tls:
      certSource: secret
      secret:
        # has keys "tls.crt" and "tls.key"
        secretName: tls-harbor
  # same secret above also has key "ca.crt"
  caSecretName: tls-harbor
  ipFamily:
    ipv6:
      enabled: false
  persistence:
    persistentVolumeClaim:
      # use NFS path on QNAP for high storage
      # components; use local-path for others
      registry:
        storageClass: nfs-qnap
        size: 20Gi
      trivy:
        storageClass: nfs-qnap
        size: 5Gi
  metrics:
    enabled: true

harbor_users:
  - username: erhhung
    realname: Erhhung Yuan
    email: erhhung@gmail.com
    # 8+ chars w/ upper + lower + digit
    password: "{{ harbor_admin_pass }}"
    role: developer # project: library
    # comment: optional

# https://github.com/goharbor/harbor/blob/main/src/portal/src/app/shared/entities/shared.const.ts#L295-L309
harbor_roles:
  projectAdmin: 1
  maintainer: 4
  developer: 2
  guest: 3
  limitedGuest: 5
